-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          model_forward         0.00%       0.000us         0.00%       0.000us       0.000us      94.581ms       214.77%      94.581ms       9.458ms           0 B           0 B           0 B           0 B            10            --  
                                    compute_group_stats         0.00%       0.000us         0.00%       0.000us       0.000us      28.832ms        65.47%      28.832ms       2.883ms           0 B           0 B           0 B           0 B            10            --  
                                                forward         0.06%     238.697us        24.06%      95.984ms       9.598ms       0.000us         0.00%      12.715ms       1.271ms       1.56 KB           0 B       1.40 GB           0 B            10            --  
                                          model_forward         8.37%      33.389ms        24.00%      95.746ms       9.575ms       0.000us         0.00%      12.715ms       1.271ms       1.56 KB       1.56 KB       1.40 GB    -898.40 MB            10            --  
                              Optimizer.step#AdamW.step         0.00%       0.000us         0.00%       0.000us       0.000us      11.231ms        25.50%      11.231ms       1.123ms           0 B           0 B           0 B           0 B            10            --  
                                               aten::mm         1.28%       5.099ms         2.02%       8.047ms      14.118us      10.368ms        23.54%      10.368ms      18.190us           0 B           0 B     729.02 MB     729.02 MB           570    189582.541  
                                         clip_grad_norm         0.00%       0.000us         0.00%       0.000us       0.000us       9.968ms        22.63%       9.968ms     996.785us           0 B           0 B           0 B           0 B            10            --  
                                     controller_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.006ms        18.18%       8.006ms     800.647us           0 B           0 B           0 B           0 B            10            --  
                                         optimizer_step         0.19%     777.587us        17.73%      70.738ms       7.074ms       0.000us         0.00%       7.407ms     740.680us           0 B           0 B      20.00 KB           0 B            10            --  
                                              aten::bmm         1.89%       7.531ms         2.65%      10.580ms       8.817us       6.325ms        14.36%       6.325ms       5.271us           0 B           0 B     659.30 MB     659.30 MB          1200     16137.585  
    autograd::engine::evaluate_function: AddmmBackward0         0.19%     738.216us         1.73%       6.920ms      53.234us       0.000us         0.00%       5.992ms      46.094us           0 B           0 B    -122.88 MB    -451.88 MB           130            --  
                                         AddmmBackward0         0.18%     727.079us         1.18%       4.696ms      36.126us       0.000us         0.00%       5.268ms      40.522us           0 B           0 B     328.75 MB           0 B           130            --  
                                           aten::linear         0.26%       1.035ms         2.81%      11.220ms      32.056us       0.000us         0.00%       5.254ms      15.010us           0 B           0 B     543.02 MB           0 B           350            --  
                                    compute_group_stats         1.63%       6.500ms         7.48%      29.860ms       2.986ms       0.000us         0.00%       5.140ms     514.026us           0 B           0 B      15.00 KB    -297.64 MB            10            --  
                                              aten::sum         2.29%       9.149ms         3.59%      14.334ms       8.635us       4.996ms        11.35%       4.996ms       3.010us           0 B           0 B    -191.00 KB    -191.00 KB          1660            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_64x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us       4.739ms        10.76%       4.739ms      24.944us           0 B           0 B           0 B           0 B           190            --  
                                            aten::copy_         1.67%       6.672ms         4.06%      16.191ms       5.379us       4.472ms        10.15%       4.472ms       1.486us           0 B           0 B           0 B           0 B          3010            --  
      autograd::engine::evaluate_function: BmmBackward0         0.39%       1.563ms         2.74%      10.915ms      27.288us       0.000us         0.00%       4.448ms      11.120us           0 B           0 B     -34.49 MB    -492.23 MB           400            --  
                                           BmmBackward0         0.43%       1.707ms         2.34%       9.353ms      23.382us       0.000us         0.00%       4.448ms      11.120us           0 B           0 B     457.73 MB           0 B           400            --  
                                            aten::addmm         0.95%       3.781ms         1.32%       5.257ms      21.904us       3.607ms         8.19%       3.609ms      15.037us           0 B           0 B     280.01 MB     280.01 MB           240     52514.171  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       3.585ms         8.14%       3.585ms       2.543us           0 B           0 B           0 B           0 B          1410            --  
       autograd::engine::evaluate_function: MmBackward0         0.09%     367.979us         1.13%       4.520ms      41.093us       0.000us         0.00%       3.538ms      32.166us           0 B           0 B    -154.49 MB    -321.76 MB           110            --  
                                            MmBackward0         0.15%     588.808us         1.04%       4.152ms      37.748us       0.000us         0.00%       3.538ms      32.166us           0 B           0 B     167.27 MB           0 B           110            --  
                                           aten::matmul         0.61%       2.444ms         3.35%      13.361ms      26.198us       0.000us         0.00%       3.483ms       6.830us           0 B           0 B     464.57 MB           0 B           510            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       3.291ms         7.47%       3.291ms       1.714us           0 B           0 B           0 B           0 B          1920            --  
    autograd::engine::evaluate_function: SliceBackward0         0.66%       2.640ms         5.03%      20.062ms      23.060us       0.000us         0.00%       2.886ms       3.317us           0 B           0 B    -124.68 MB      -1.12 GB           870            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x64_8...         0.00%       0.000us         0.00%       0.000us       0.000us       2.557ms         5.81%       2.557ms      14.206us           0 B           0 B           0 B           0 B           180            --  
                                            aten::clone         0.46%       1.819ms         2.66%      10.595ms       9.376us       0.000us         0.00%       2.075ms       1.836us           0 B           0 B     855.86 MB           0 B          1130            --  
                                         SliceBackward0         0.27%       1.071ms         3.78%      15.087ms      17.341us       0.000us         0.00%       2.000ms       2.299us           0 B           0 B     939.18 MB           0 B           870            --  
                                   aten::slice_backward         0.44%       1.747ms         3.51%      14.015ms      16.110us       0.000us         0.00%       2.000ms       2.299us           0 B           0 B     939.18 MB           0 B           870            --  
void magma_sgemmEx_kernel<float, float, float, true,...         0.00%       0.000us         0.00%       0.000us       0.000us       1.890ms         4.29%       1.890ms       9.449us           0 B           0 B           0 B           0 B           200            --  
void magma_sgemmEx_kernel<float, float, float, false...         0.00%       0.000us         0.00%       0.000us       0.000us       1.804ms         4.10%       1.804ms       6.441us           0 B           0 B           0 B           0 B           280            --  
                                    base_optimizer_step         0.08%     330.242us         3.83%      15.277ms       1.528ms       0.000us         0.00%       1.757ms     175.693us           0 B           0 B           0 B           0 B            10            --  
                              Optimizer.step#AdamW.step         2.10%       8.385ms         3.75%      14.947ms       1.495ms       0.000us         0.00%       1.757ms     175.693us           0 B         -80 B           0 B    -145.64 MB            10            --  
                                              aten::pow         1.53%       6.088ms         2.66%      10.596ms       7.257us       1.552ms         3.52%       1.639ms       1.123us           0 B           0 B     508.96 MB     508.96 MB          1460            --  
                                              aten::mul         1.26%       5.026ms         2.04%       8.146ms       6.364us       1.562ms         3.55%       1.562ms       1.220us         312 B         312 B       1.13 GB       1.13 GB          1280       280.261  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us       1.552ms         3.52%       1.552ms       1.133us           0 B           0 B           0 B           0 B          1370            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_64x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us       1.390ms         3.16%       1.390ms       5.792us           0 B           0 B           0 B           0 B           240            --  
void sgemm_largek_lds64<true, false, 5, 5, 4, 4, 4, ...         0.00%       0.000us         0.00%       0.000us       0.000us       1.357ms         3.08%       1.357ms      33.925us           0 B           0 B           0 B           0 B            40            --  
void magma_sgemmEx_kernel<float, float, float, false...         0.00%       0.000us         0.00%       0.000us       0.000us       1.291ms         2.93%       1.291ms       5.381us           0 B           0 B           0 B           0 B           240            --  
autograd::engine::evaluate_function: ConvolutionBack...         0.10%     398.748us         1.28%       5.113ms      42.611us       0.000us         0.00%       1.249ms      10.405us           0 B           0 B    -110.43 MB    -248.91 MB           120            --  
                                   ConvolutionBackward0         0.09%     347.060us         1.18%       4.715ms      39.288us       0.000us         0.00%       1.249ms      10.405us           0 B           0 B     138.48 MB           0 B           120            --  
                             aten::convolution_backward         0.36%       1.426ms         1.09%       4.368ms      36.396us     730.789us         1.66%       1.249ms      10.405us           0 B           0 B     138.48 MB    -121.69 MB           120            --  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.174ms         2.67%       1.174ms       4.695us           0 B           0 B           0 B           0 B           250            --  
                                             aten::add_         0.50%       1.978ms         0.96%       3.839ms       2.666us       1.151ms         2.61%       1.151ms       0.800us           0 B           0 B           0 B           0 B          1440            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x64_8...         0.00%       0.000us         0.00%       0.000us       0.000us       1.141ms         2.59%       1.141ms      11.411us           0 B           0 B           0 B           0 B           100            --  
                                       aten::contiguous         0.06%     224.950us         0.70%       2.797ms       9.644us       0.000us         0.00%       1.105ms       3.812us           0 B           0 B     333.40 MB           0 B           290            --  
                                            aten::fill_         0.65%       2.594ms         1.44%       5.762ms       4.467us       1.061ms         2.41%       1.061ms       0.823us           0 B           0 B           0 B           0 B          1290            --  
      autograd::engine::evaluate_function: MulBackward0         0.26%       1.028ms         1.23%       4.916ms      16.385us       0.000us         0.00%       1.002ms       3.340us      -1.56 KB      -1.56 KB    -100.62 MB    -511.55 MB           300            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     990.402us         2.25%     990.402us       1.238us           0 B           0 B           0 B           0 B           800            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     937.042us         2.13%     937.042us       0.829us           0 B           0 B           0 B           0 B          1130            --  
                                              aten::cat         0.56%       2.227ms         0.84%       3.343ms       7.959us     924.429us         2.10%     925.580us       2.204us           0 B           0 B     296.59 MB     296.59 MB           420            --  
      autograd::engine::evaluate_function: DivBackward0         0.12%     460.867us         1.05%       4.183ms      46.481us       0.000us         0.00%     924.403us      10.271us           0 B           0 B     -93.51 MB    -279.53 MB            90            --  
                                            aten::zero_         0.33%       1.326ms         1.55%       6.200ms       5.586us       0.000us         0.00%     921.042us       0.830us           0 B           0 B           0 B           0 B          1110            --  
                                           aten::conv1d         0.05%     202.778us         1.06%       4.215ms      35.125us       0.000us         0.00%     919.071us       7.659us           0 B           0 B     130.23 MB           0 B           120            --  
                                      aten::convolution         0.11%     432.944us         1.01%       4.012ms      33.435us       0.000us         0.00%     919.071us       7.659us           0 B           0 B     130.23 MB     -43.66 MB           120            --  
                                     aten::_convolution         0.20%     781.982us         0.90%       3.579ms      29.827us       0.000us         0.00%     919.071us       7.659us           0 B           0 B     173.89 MB    -103.97 MB           120            --  
                                              aten::div         0.52%       2.059ms         0.87%       3.486ms       6.456us     850.945us         1.93%     850.945us       1.576us         112 B         112 B     488.36 MB     488.36 MB           540            --  
                                      aten::masked_fill         0.32%       1.288ms         2.03%       8.098ms      25.305us       0.000us         0.00%     830.205us       2.594us           0 B           0 B     310.70 MB           0 B           320            --  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     802.621us         1.82%     802.621us       0.923us           0 B           0 B           0 B           0 B           870            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us     774.912us         1.76%     774.912us      12.915us           0 B           0 B           0 B           0 B            60            --  
                                            aten::zeros         0.32%       1.278ms         1.95%       7.780ms       8.549us       0.000us         0.00%     762.706us       0.838us           0 B           0 B     951.46 MB           0 B           910            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us     734.338us         1.67%     734.338us      18.358us           0 B           0 B           0 B           0 B            40            --  
autograd::engine::evaluate_function: torch::autograd...         0.18%     699.042us         1.93%       7.709ms      38.544us       0.000us         0.00%     717.920us       3.590us           0 B           0 B           0 B    -238.43 MB           200            --  
                            torch::autograd::CopySlices         0.27%       1.085ms         1.76%       7.010ms      35.049us       0.000us         0.00%     717.920us       3.590us           0 B           0 B     238.43 MB     -59.89 MB           200            --  
void magma_sgemmEx_kernel<float, float, float, true,...         0.00%       0.000us         0.00%       0.000us       0.000us     674.170us         1.53%     674.170us       4.214us           0 B           0 B           0 B           0 B           160            --  
                                           DivBackward0         0.11%     451.636us         0.70%       2.803ms      31.141us       0.000us         0.00%     656.559us       7.295us           0 B           0 B     185.62 MB    -308.79 MB            90            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     647.127us         1.47%     647.127us       1.294us           0 B           0 B           0 B           0 B           500            --  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     627.496us         1.42%     627.496us       1.961us           0 B           0 B           0 B           0 B           320            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     611.997us         1.39%     611.997us       1.800us           0 B           0 B           0 B           0 B           340            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     590.851us         1.34%     590.851us       1.641us           0 B           0 B           0 B           0 B           360            --  
                                    aten::_foreach_mul_         0.20%     786.766us         0.51%       2.024ms      40.471us     565.118us         1.28%     588.062us      11.761us           0 B           0 B           0 B           0 B            50            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     585.178us         1.33%     585.178us       0.975us           0 B           0 B           0 B           0 B           600            --  
                                              aten::add         0.46%       1.816ms         0.73%       2.903ms       7.444us     547.427us         1.24%     547.427us       1.404us           0 B           0 B     205.45 MB     205.45 MB           390        51.807  
                                           MulBackward0         0.14%     565.192us         0.69%       2.748ms       9.161us       0.000us         0.00%     535.327us       1.784us           0 B           0 B     412.50 MB           0 B           300            --  
                                     aten::masked_fill_         0.31%       1.240ms         0.64%       2.571ms       8.035us     521.757us         1.18%     521.757us       1.630us           0 B           0 B           0 B           0 B           320            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     521.757us         1.18%     521.757us       1.630us           0 B           0 B           0 B           0 B           320            --  
void cublasLt::splitKreduce_kernel<32, 16, int, floa...         0.00%       0.000us         0.00%       0.000us       0.000us     513.404us         1.17%     513.404us       1.975us           0 B           0 B           0 B           0 B           260            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     488.639us         1.11%     488.639us      12.216us           0 B           0 B           0 B           0 B            40            --  
autograd::engine::evaluate_function: SoftmaxBackward...         0.15%     580.524us         0.88%       3.502ms      17.510us       0.000us         0.00%     468.647us       2.343us           0 B           0 B    -164.80 MB    -339.38 MB           200            --  
                                       SoftmaxBackward0         0.10%     381.103us         0.73%       2.922ms      14.608us       0.000us         0.00%     468.647us       2.343us           0 B           0 B     174.57 MB           0 B           200            --  
                           aten::_softmax_backward_data         0.25%     992.339us         0.64%       2.540ms      12.702us     235.297us         0.53%     468.647us       2.343us           0 B           0 B     174.57 MB      14.26 MB           200            --  
                                           aten::arange         0.34%       1.357ms         1.21%       4.836ms       7.328us     227.480us         0.52%     454.960us       0.689us           0 B           0 B     480.00 KB         512 B           660            --  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     443.434us         1.01%     443.434us       0.498us           0 B           0 B           0 B           0 B           890            --  
autograd::engine::evaluate_function: MaskedFillBackw...         0.14%     573.798us         1.26%       5.021ms      31.378us       0.000us         0.00%     438.559us       2.741us           0 B           0 B      -4.73 MB    -165.43 MB           160            --  
                                    MaskedFillBackward0         0.05%     217.418us         1.11%       4.447ms      27.792us       0.000us         0.00%     438.559us       2.741us           0 B           0 B     160.70 MB           0 B           160            --  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.02%      91.742us         0.20%     816.240us      40.812us       0.000us         0.00%     427.201us      21.360us           0 B           0 B      -7.83 MB     -29.86 MB            20            --  
                                aten::_conv_depthwise2d         0.11%     439.196us         0.27%       1.079ms       8.988us     419.130us         0.95%     419.130us       3.493us           0 B           0 B     130.23 MB           0 B           120            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     419.130us         0.95%     419.130us       3.493us           0 B           0 B           0 B           0 B           120            --  
                                     EmbeddingBackward0         0.01%      33.051us         0.17%     672.455us      33.623us       0.000us         0.00%     409.313us      20.466us           0 B           0 B      12.27 MB           0 B            20            --  
                               aten::embedding_backward         0.01%      28.971us         0.16%     639.404us      31.970us       0.000us         0.00%     409.313us      20.466us           0 B           0 B      12.27 MB           0 B            20            --  
                         aten::embedding_dense_backward         0.03%     123.234us         0.15%     610.433us      30.522us     348.897us         0.79%     409.313us      20.466us           0 B           0 B      12.27 MB     -20.08 MB            20            --  
      autograd::engine::evaluate_function: PowBackward0         0.10%     389.917us         0.83%       3.312ms      36.798us       0.000us         0.00%     403.396us       4.482us           0 B           0 B    -188.09 MB    -308.89 MB            90            --  
                                   aten::_foreach_lerp_         0.04%     141.735us         0.05%     205.588us      10.279us     374.688us         0.85%     374.688us      18.734us           0 B           0 B           0 B           0 B            20            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     374.688us         0.85%     374.688us      18.734us           0 B           0 B           0 B           0 B            20            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     369.508us         0.84%     369.508us       3.079us           0 B           0 B           0 B           0 B           120            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     361.281us         0.82%     361.281us       3.011us           0 B           0 B           0 B           0 B           120            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     359.422us         0.82%     359.422us       1.797us           0 B           0 B           0 B           0 B           200            --  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     358.211us         0.81%     358.211us       1.791us           0 B           0 B           0 B           0 B           200            --  
void at::native::(anonymous namespace)::embedding_ba...         0.00%       0.000us         0.00%       0.000us       0.000us     348.897us         0.79%     348.897us      17.445us           0 B           0 B           0 B           0 B            20            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 398.947ms
Self CUDA time total: 44.039ms
