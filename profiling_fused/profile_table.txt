-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          model_forward         0.00%       0.000us         0.00%       0.000us       0.000us      37.900ms       190.62%      37.900ms       7.580ms           0 B           0 B           0 B           0 B             5            --  
                                                forward         0.06%      88.295us        24.32%      38.543ms       7.709ms       0.000us         0.00%       6.330ms       1.266ms         800 B           0 B     716.70 MB           0 B             5            --  
                                          model_forward         7.86%      12.463ms        24.26%      38.454ms       7.691ms       0.000us         0.00%       6.330ms       1.266ms         800 B         800 B     716.70 MB    -439.63 MB             5            --  
                                     controller_forward         0.00%       0.000us         0.00%       0.000us       0.000us       5.530ms        27.81%       5.530ms       1.106ms           0 B           0 B           0 B           0 B             5            --  
                                               aten::mm         1.31%       2.073ms         2.19%       3.464ms      12.154us       5.158ms        25.94%       5.158ms      18.097us           0 B           0 B     361.39 MB     361.39 MB           285     94791.270  
                              Optimizer.step#AdamW.step         0.00%       0.000us         0.00%       0.000us       0.000us       4.944ms        24.87%       4.944ms     988.806us           0 B           0 B           0 B           0 B             5            --  
                                   clip_grad_norm_fused         0.00%       0.000us         0.00%       0.000us       0.000us       4.936ms        24.83%       4.936ms     987.282us           0 B           0 B           0 B           0 B             5            --  
                                    compute_group_stats         0.00%       0.000us         0.00%       0.000us       0.000us       4.655ms        23.41%       4.655ms     931.053us           0 B           0 B           0 B           0 B             5            --  
                                              aten::bmm         2.02%       3.200ms         2.89%       4.574ms       7.623us       3.179ms        15.99%       3.179ms       5.299us           0 B           0 B     321.54 MB     321.54 MB           600      8068.792  
    autograd::engine::evaluate_function: AddmmBackward0         0.17%     272.518us         1.80%       2.854ms      43.901us       0.000us         0.00%       3.003ms      46.207us           0 B           0 B     -61.44 MB    -225.94 MB            65            --  
                                         AddmmBackward0         0.16%     249.728us         1.23%       1.949ms      29.992us       0.000us         0.00%       2.620ms      40.308us           0 B           0 B     164.38 MB           0 B            65            --  
                                           aten::linear         0.26%     405.866us         2.64%       4.186ms      23.918us       0.000us         0.00%       2.611ms      14.920us           0 B           0 B     265.88 MB           0 B           175            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_64x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us       2.365ms        11.90%       2.365ms      24.896us           0 B           0 B           0 B           0 B            95            --  
      autograd::engine::evaluate_function: BmmBackward0         0.38%     605.280us         2.88%       4.557ms      22.784us       0.000us         0.00%       2.246ms      11.229us           0 B           0 B     -28.96 MB    -249.73 MB           200            --  
                                           BmmBackward0         0.41%     653.034us         2.49%       3.951ms      19.757us       0.000us         0.00%       2.246ms      11.229us           0 B           0 B     220.76 MB           0 B           200            --  
                                            aten::copy_         1.79%       2.841ms         4.62%       7.322ms       4.865us       2.238ms        11.26%       2.238ms       1.487us           0 B           0 B           0 B           0 B          1505            --  
                                            aten::addmm         0.79%       1.253ms         1.14%       1.806ms      15.052us       1.790ms         9.00%       1.792ms      14.932us           0 B           0 B     137.50 MB     137.50 MB           120     26257.085  
       autograd::engine::evaluate_function: MmBackward0         0.10%     153.786us         1.29%       2.042ms      37.131us       0.000us         0.00%       1.760ms      31.996us           0 B           0 B     -71.62 MB    -155.25 MB            55            --  
                                            MmBackward0         0.18%     284.417us         1.19%       1.888ms      34.335us       0.000us         0.00%       1.760ms      31.996us           0 B           0 B      83.63 MB           0 B            55            --  
                                           aten::matmul         0.62%     978.615us         3.51%       5.561ms      21.810us       0.000us         0.00%       1.733ms       6.797us           0 B           0 B     229.16 MB           0 B           255            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.648ms         8.29%       1.648ms       1.717us           0 B           0 B           0 B           0 B           960            --  
                                         optimizer_step         0.16%     246.799us        15.60%      24.716ms       4.943ms       0.000us         0.00%       1.626ms     325.140us           0 B           0 B     188.00 KB           0 B             5            --  
    autograd::engine::evaluate_function: SliceBackward0         0.68%       1.073ms         5.20%       8.233ms      18.927us       0.000us         0.00%       1.441ms       3.312us           0 B           0 B     -55.60 MB    -565.98 MB           435            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x64_8...         0.00%       0.000us         0.00%       0.000us       0.000us       1.278ms         6.43%       1.278ms      14.205us           0 B           0 B           0 B           0 B            90            --  
                                            aten::clone         0.49%     770.137us         2.88%       4.564ms       8.078us       0.000us         0.00%       1.042ms       1.843us           0 B           0 B     412.46 MB           0 B           565            --  
                                         SliceBackward0         0.27%     430.935us         3.89%       6.170ms      14.184us       0.000us         0.00%     999.079us       2.297us           0 B           0 B     463.34 MB           0 B           435            --  
                                   aten::slice_backward         0.44%     691.087us         3.62%       5.739ms      13.193us       0.000us         0.00%     999.079us       2.297us           0 B           0 B     463.34 MB           0 B           435            --  
void magma_sgemmEx_kernel<float, float, float, true,...         0.00%       0.000us         0.00%       0.000us       0.000us     945.060us         4.75%     945.060us       9.451us           0 B           0 B           0 B           0 B           100            --  
void magma_sgemmEx_kernel<float, float, float, false...         0.00%       0.000us         0.00%       0.000us       0.000us     912.259us         4.59%     912.259us       6.516us           0 B           0 B           0 B           0 B           140            --  
                                    base_optimizer_step         0.08%     132.806us         4.17%       6.606ms       1.321ms       0.000us         0.00%     902.399us     180.480us           0 B           0 B           0 B           0 B             5            --  
                              Optimizer.step#AdamW.step         2.35%       3.729ms         4.08%       6.473ms       1.295ms       0.000us         0.00%     902.399us     180.480us           0 B         -40 B           0 B     -72.82 MB             5            --  
                                              aten::sum         0.59%     937.161us         0.99%       1.573ms       8.068us     791.884us         3.98%     791.884us       4.061us           0 B           0 B     435.00 KB     433.50 KB           195            --  
                                              aten::mul         1.30%       2.067ms         2.14%       3.398ms       5.309us     782.281us         3.93%     782.281us       1.222us         160 B         160 B     564.19 MB     564.19 MB           640       140.131  
void cutlass::Kernel2<cutlass_80_simt_sgemm_64x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us     694.749us         3.49%     694.749us       5.790us           0 B           0 B           0 B           0 B           120            --  
void sgemm_largek_lds64<true, false, 5, 5, 4, 4, 4, ...         0.00%       0.000us         0.00%       0.000us       0.000us     669.661us         3.37%     669.661us      33.483us           0 B           0 B           0 B           0 B            20            --  
void magma_sgemmEx_kernel<float, float, float, false...         0.00%       0.000us         0.00%       0.000us       0.000us     647.170us         3.25%     647.170us       5.393us           0 B           0 B           0 B           0 B           120            --  
autograd::engine::evaluate_function: ConvolutionBack...         0.10%     157.046us         1.34%       2.121ms      35.354us       0.000us         0.00%     627.832us      10.464us           0 B           0 B     -55.21 MB    -124.45 MB            60            --  
                                   ConvolutionBackward0         0.08%     123.654us         1.24%       1.964ms      32.737us       0.000us         0.00%     627.832us      10.464us           0 B           0 B      69.24 MB           0 B            60            --  
                             aten::convolution_backward         0.34%     542.016us         1.16%       1.841ms      30.676us     366.267us         1.84%     627.832us      10.464us           0 B           0 B      69.24 MB     -61.88 MB            60            --  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     583.813us         2.94%     583.813us       4.671us           0 B           0 B           0 B           0 B           125            --  
                                             aten::add_         0.53%     840.739us         1.07%       1.691ms       2.349us     576.737us         2.90%     576.737us       0.801us           0 B           0 B           0 B           0 B           720            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x64_8...         0.00%       0.000us         0.00%       0.000us       0.000us     570.397us         2.87%     570.397us      11.408us           0 B           0 B           0 B           0 B            50            --  
                                       aten::contiguous         0.06%      87.800us         0.81%       1.285ms       8.859us       0.000us         0.00%     556.382us       3.837us           0 B           0 B     157.33 MB           0 B           145            --  
                                            aten::fill_         0.58%     923.581us         1.52%       2.405ms       3.612us     546.692us         2.75%     546.692us       0.821us           0 B           0 B           0 B           0 B           666            --  
      autograd::engine::evaluate_function: MulBackward0         0.28%     442.641us         1.33%       2.115ms      14.099us       0.000us         0.00%     506.732us       3.378us        -800 B        -800 B     -46.79 MB    -244.88 MB           150            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     494.812us         2.49%     494.812us       1.237us           0 B           0 B           0 B           0 B           400            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     484.356us         2.44%     484.356us       0.827us           0 B           0 B           0 B           0 B           586            --  
                                            aten::zero_         0.34%     532.921us         1.60%       2.536ms       4.402us       0.000us         0.00%     476.740us       0.828us           0 B           0 B           0 B           0 B           576            --  
      autograd::engine::evaluate_function: DivBackward0         0.12%     186.940us         1.13%       1.787ms      39.700us       0.000us         0.00%     464.349us      10.319us           0 B           0 B     -43.63 MB    -136.64 MB            45            --  
                                           aten::conv1d         0.05%      75.952us         1.12%       1.781ms      29.678us       0.000us         0.00%     460.928us       7.682us           0 B           0 B      68.18 MB           0 B            60            --  
                                      aten::convolution         0.10%     160.614us         1.08%       1.705ms      28.412us       0.000us         0.00%     460.928us       7.682us           0 B           0 B      68.18 MB     -29.19 MB            60            --  
                                     aten::_convolution         0.20%     323.027us         0.97%       1.544ms      25.735us       0.000us         0.00%     460.928us       7.682us           0 B           0 B      97.38 MB     -36.73 MB            60            --  
                                              aten::cat         0.56%     889.820us         0.87%       1.384ms       6.592us     458.590us         2.31%     459.678us       2.189us           0 B           0 B     145.17 MB     145.17 MB           210            --  
                                    compute_group_stats         0.53%     836.353us         3.09%       4.891ms     978.283us       0.000us         0.00%     447.042us      89.408us           0 B           0 B     185.50 KB    -175.00 KB             5            --  
                                              aten::div         0.51%     812.687us         0.87%       1.372ms       5.081us     427.709us         2.15%     427.709us       1.584us          72 B          72 B     237.93 MB     237.93 MB           270            --  
                                      aten::masked_fill         0.33%     516.111us         2.08%       3.292ms      20.574us       0.000us         0.00%     415.624us       2.598us           0 B           0 B     152.38 MB           0 B           160            --  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     400.955us         2.02%     400.955us       0.922us           0 B           0 B           0 B           0 B           435            --  
                                            aten::zeros         0.35%     551.185us         2.03%       3.211ms       6.817us       0.000us         0.00%     393.537us       0.836us           0 B           0 B     469.49 MB           0 B           471            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us     386.655us         1.94%     386.655us      12.888us           0 B           0 B           0 B           0 B            30            --  
                                    aten::_foreach_norm         0.68%       1.082ms         1.64%       2.598ms     103.938us     296.704us         1.49%     372.160us      14.886us           0 B           0 B     465.00 KB     450.00 KB            25            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us     365.665us         1.84%     365.665us      18.283us           0 B           0 B           0 B           0 B            20            --  
autograd::engine::evaluate_function: torch::autograd...         0.16%     260.887us         2.06%       3.267ms      32.670us       0.000us         0.00%     358.904us       3.589us           0 B           0 B           0 B    -115.19 MB           100            --  
                            torch::autograd::CopySlices         0.26%     407.148us         1.90%       3.006ms      30.061us       0.000us         0.00%     358.904us       3.589us           0 B           0 B     115.19 MB     -30.54 MB           100            --  
void magma_sgemmEx_kernel<float, float, float, true,...         0.00%       0.000us         0.00%       0.000us       0.000us     332.927us         1.67%     332.927us       4.162us           0 B           0 B           0 B           0 B            80            --  
                                           DivBackward0         0.11%     166.752us         0.76%       1.204ms      26.762us       0.000us         0.00%     329.530us       7.323us           0 B           0 B      92.81 MB    -148.77 MB            45            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     320.417us         1.61%     320.417us       1.282us           0 B           0 B           0 B           0 B           250            --  
                                    aten::_foreach_mul_         0.22%     348.774us         0.87%       1.374ms      54.976us     290.366us         1.46%     313.310us      12.532us           0 B           0 B           0 B           0 B            25            --  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     310.718us         1.56%     310.718us       1.942us           0 B           0 B           0 B           0 B           160            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     306.404us         1.54%     306.404us       1.802us           0 B           0 B           0 B           0 B           170            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     297.437us         1.50%     297.437us       1.652us           0 B           0 B           0 B           0 B           180            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     293.798us         1.48%     293.798us       0.979us           0 B           0 B           0 B           0 B           300            --  
                                              aten::add         0.45%     717.734us         0.71%       1.120ms       5.746us     272.541us         1.37%     272.541us       1.398us           0 B           0 B     105.85 MB     105.85 MB           195        25.904  
                                           MulBackward0         0.15%     231.410us         0.76%       1.203ms       8.021us       0.000us         0.00%     269.928us       1.800us           0 B           0 B     198.05 MB           0 B           150            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     269.857us         1.36%     269.857us      10.794us           0 B           0 B           0 B           0 B            25            --  
                                     aten::masked_fill_         0.31%     498.669us         0.65%       1.034ms       6.464us     261.704us         1.32%     261.704us       1.636us           0 B           0 B           0 B           0 B           160            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     261.704us         1.32%     261.704us       1.636us           0 B           0 B           0 B           0 B           160            --  
void cublasLt::splitKreduce_kernel<32, 16, int, floa...         0.00%       0.000us         0.00%       0.000us       0.000us     256.611us         1.29%     256.611us       1.974us           0 B           0 B           0 B           0 B           130            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     251.999us         1.27%     251.999us      12.600us           0 B           0 B           0 B           0 B            20            --  
autograd::engine::evaluate_function: SoftmaxBackward...         0.12%     195.710us         0.91%       1.448ms      14.481us       0.000us         0.00%     230.431us       2.304us           0 B           0 B     -81.35 MB    -167.27 MB           100            --  
                                       SoftmaxBackward0         0.10%     153.336us         0.79%       1.252ms      12.524us       0.000us         0.00%     230.431us       2.304us           0 B           0 B      85.92 MB           0 B           100            --  
                           aten::_softmax_backward_data         0.25%     391.601us         0.69%       1.099ms      10.990us     117.053us         0.59%     230.431us       2.304us           0 B           0 B      85.92 MB       5.76 MB           100            --  
                                           aten::arange         0.35%     547.388us         1.28%       2.027ms       6.141us     113.126us         0.57%     226.252us       0.686us           0 B           0 B     240.00 KB           0 B           330            --  
autograd::engine::evaluate_function: MaskedFillBackw...         0.14%     214.608us         1.15%       1.821ms      22.759us       0.000us         0.00%     220.164us       2.752us           0 B           0 B      -3.96 MB     -81.35 MB            80            --  
                                    MaskedFillBackward0         0.05%      75.433us         1.01%       1.606ms      20.076us       0.000us         0.00%     220.164us       2.752us           0 B           0 B      77.38 MB           0 B            80            --  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.03%      42.411us         0.26%     409.037us      40.904us       0.000us         0.00%     213.697us      21.370us           0 B           0 B      -3.92 MB     -14.93 MB            10            --  
                                aten::_conv_depthwise2d         0.11%     182.205us         0.29%     451.754us       7.529us     210.176us         1.06%     210.176us       3.503us           0 B           0 B      68.18 MB           0 B            60            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     210.176us         1.06%     210.176us       3.503us           0 B           0 B           0 B           0 B            60            --  
                                     EmbeddingBackward0         0.01%      15.831us         0.21%     340.726us      34.073us       0.000us         0.00%     204.545us      20.455us           0 B           0 B       6.13 MB           0 B            10            --  
                               aten::embedding_backward         0.01%      12.310us         0.21%     324.895us      32.490us       0.000us         0.00%     204.545us      20.455us           0 B           0 B       6.13 MB           0 B            10            --  
                         aten::embedding_dense_backward         0.04%      57.645us         0.20%     312.585us      31.258us     174.464us         0.88%     204.545us      20.455us           0 B           0 B       6.13 MB     -10.04 MB            10            --  
      autograd::engine::evaluate_function: PowBackward0         0.10%     155.438us         0.87%       1.380ms      30.661us       0.000us         0.00%     201.087us       4.469us           0 B           0 B     -94.04 MB    -150.75 MB            45            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     185.341us         0.93%     185.341us       3.089us           0 B           0 B           0 B           0 B            60            --  
                                   aten::_foreach_lerp_         0.04%      58.781us         0.05%      86.501us       8.650us     183.008us         0.92%     183.008us      18.301us           0 B           0 B           0 B           0 B            10            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     183.008us         0.92%     183.008us      18.301us           0 B           0 B           0 B           0 B            10            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     182.977us         0.92%     182.977us       1.830us           0 B           0 B           0 B           0 B           100            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     180.926us         0.91%     180.926us       3.015us           0 B           0 B           0 B           0 B            60            --  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     179.259us         0.90%     179.259us       1.793us           0 B           0 B           0 B           0 B           100            --  
void at::native::(anonymous namespace)::embedding_ba...         0.00%       0.000us         0.00%       0.000us       0.000us     174.464us         0.88%     174.464us      17.446us           0 B           0 B           0 B           0 B            10            --  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     165.699us         0.83%     165.699us       0.526us           0 B           0 B           0 B           0 B           315            --  
                                   clip_grad_norm_fused         1.26%       2.003ms         4.26%       6.746ms       1.349ms       0.000us         0.00%     162.469us      32.494us           0 B           0 B           0 B    -167.50 KB             5            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 158.482ms
Self CUDA time total: 19.883ms
