-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          model_forward         0.00%       0.000us         0.00%       0.000us       0.000us      40.123ms       182.27%      40.123ms       8.025ms           0 B           0 B           0 B           0 B             5            --  
                                    compute_group_stats         0.00%       0.000us         0.00%       0.000us       0.000us      12.933ms        58.75%      12.933ms       2.587ms           0 B           0 B           0 B           0 B             5            --  
                                         clip_grad_norm         0.00%       0.000us         0.00%       0.000us       0.000us       6.536ms        29.69%       6.536ms       1.307ms           0 B           0 B           0 B           0 B             5            --  
                                                forward         0.05%      96.742us        22.63%      40.839ms       8.168ms       0.000us         0.00%       6.339ms       1.268ms         800 B           0 B     716.70 MB           0 B             5            --  
                                          model_forward         7.21%      13.007ms        22.58%      40.742ms       8.148ms       0.000us         0.00%       6.339ms       1.268ms         800 B         800 B     716.70 MB    -439.63 MB             5            --  
                                     controller_forward         0.00%       0.000us         0.00%       0.000us       0.000us       5.558ms        25.25%       5.558ms       1.112ms           0 B           0 B           0 B           0 B             5            --  
                              Optimizer.step#AdamW.step         0.00%       0.000us         0.00%       0.000us       0.000us       5.543ms        25.18%       5.543ms       1.109ms           0 B           0 B           0 B           0 B             5            --  
                                               aten::mm         1.28%       2.311ms         2.03%       3.666ms      12.863us       5.163ms        23.46%       5.163ms      18.117us           0 B           0 B     361.39 MB     361.39 MB           285     94791.270  
                                         optimizer_step         0.17%     302.853us        19.93%      35.964ms       7.193ms       0.000us         0.00%       3.808ms     761.530us           0 B           0 B      10.00 KB           0 B             5            --  
                                              aten::bmm         1.94%       3.499ms         2.75%       4.970ms       8.283us       3.159ms        14.35%       3.159ms       5.264us           0 B           0 B     321.54 MB     321.54 MB           600      8068.792  
    autograd::engine::evaluate_function: AddmmBackward0         0.20%     366.351us         1.76%       3.174ms      48.832us       0.000us         0.00%       2.969ms      45.678us           0 B           0 B     -61.44 MB    -225.94 MB            65            --  
                                           aten::linear         0.25%     449.626us         2.71%       4.893ms      27.962us       0.000us         0.00%       2.620ms      14.972us           0 B           0 B     265.88 MB           0 B           175            --  
                                         AddmmBackward0         0.16%     293.537us         1.15%       2.084ms      32.055us       0.000us         0.00%       2.618ms      40.270us           0 B           0 B     164.38 MB           0 B            65            --  
                                    compute_group_stats         1.47%       2.661ms         7.40%      13.352ms       2.670ms       0.000us         0.00%       2.560ms     511.930us           0 B           0 B       7.50 KB    -148.82 MB             5            --  
                                              aten::sum         2.25%       4.062ms         3.62%       6.526ms       7.862us       2.481ms        11.27%       2.481ms       2.989us           0 B           0 B     752.50 KB     752.00 KB           830            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_64x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us       2.364ms        10.74%       2.364ms      24.880us           0 B           0 B           0 B           0 B            95            --  
                                            aten::copy_         1.71%       3.094ms         4.28%       7.719ms       5.129us       2.237ms        10.16%       2.238ms       1.487us           0 B           0 B           0 B           0 B          1505            --  
      autograd::engine::evaluate_function: BmmBackward0         0.37%     659.877us         2.72%       4.900ms      24.498us       0.000us         0.00%       2.224ms      11.121us           0 B           0 B     -28.96 MB    -249.73 MB           200            --  
                                           BmmBackward0         0.41%     740.302us         2.35%       4.240ms      21.199us       0.000us         0.00%       2.224ms      11.121us           0 B           0 B     220.76 MB           0 B           200            --  
                                            aten::addmm         0.82%       1.486ms         1.18%       2.127ms      17.723us       1.799ms         8.17%       1.801ms      15.008us           0 B           0 B     137.50 MB     137.50 MB           120     26257.085  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us       1.793ms         8.15%       1.793ms       2.544us           0 B           0 B           0 B           0 B           705            --  
       autograd::engine::evaluate_function: MmBackward0         0.09%     163.456us         1.17%       2.118ms      38.506us       0.000us         0.00%       1.768ms      32.141us           0 B           0 B     -71.62 MB    -155.25 MB            55            --  
                                            MmBackward0         0.15%     261.730us         1.08%       1.954ms      35.534us       0.000us         0.00%       1.768ms      32.141us           0 B           0 B      83.63 MB           0 B            55            --  
                                           aten::matmul         0.57%       1.033ms         3.43%       6.181ms      24.238us       0.000us         0.00%       1.734ms       6.801us           0 B           0 B     229.16 MB           0 B           255            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       1.646ms         7.48%       1.646ms       1.714us           0 B           0 B           0 B           0 B           960            --  
    autograd::engine::evaluate_function: SliceBackward0         0.66%       1.190ms         4.84%       8.739ms      20.091us       0.000us         0.00%       1.441ms       3.314us           0 B           0 B     -56.60 MB    -566.98 MB           435            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x64_8...         0.00%       0.000us         0.00%       0.000us       0.000us       1.279ms         5.81%       1.279ms      14.207us           0 B           0 B           0 B           0 B            90            --  
                                            aten::clone         0.45%     809.498us         2.64%       4.764ms       8.432us       0.000us         0.00%       1.041ms       1.843us           0 B           0 B     412.46 MB           0 B           565            --  
                                         SliceBackward0         0.26%     477.792us         3.58%       6.455ms      14.840us       0.000us         0.00%     999.741us       2.298us           0 B           0 B     463.34 MB           0 B           435            --  
                                   aten::slice_backward         0.42%     757.796us         3.31%       5.978ms      13.741us       0.000us         0.00%     999.741us       2.298us           0 B           0 B     463.34 MB           0 B           435            --  
void magma_sgemmEx_kernel<float, float, float, true,...         0.00%       0.000us         0.00%       0.000us       0.000us     938.017us         4.26%     938.017us       9.380us           0 B           0 B           0 B           0 B           100            --  
                                    base_optimizer_step         0.07%     133.021us         4.00%       7.211ms       1.442ms       0.000us         0.00%     926.178us     185.236us           0 B           0 B           0 B           0 B             5            --  
                              Optimizer.step#AdamW.step         2.25%       4.062ms         3.92%       7.078ms       1.416ms       0.000us         0.00%     926.178us     185.236us           0 B         -40 B           0 B     -72.82 MB             5            --  
void magma_sgemmEx_kernel<float, float, float, false...         0.00%       0.000us         0.00%       0.000us       0.000us     907.071us         4.12%     907.071us       6.479us           0 B           0 B           0 B           0 B           140            --  
                                              aten::pow         1.53%       2.757ms         2.72%       4.907ms       6.722us     773.162us         3.51%     816.489us       1.118us           0 B           0 B     245.10 MB     245.10 MB           730            --  
                                              aten::mul         1.30%       2.338ms         2.08%       3.760ms       5.875us     775.679us         3.52%     775.679us       1.212us         128 B         128 B     564.19 MB     564.19 MB           640       140.131  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     773.162us         3.51%     773.162us       1.129us           0 B           0 B           0 B           0 B           685            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_64x64_8x...         0.00%       0.000us         0.00%       0.000us       0.000us     696.743us         3.17%     696.743us       5.806us           0 B           0 B           0 B           0 B           120            --  
void sgemm_largek_lds64<true, false, 5, 5, 4, 4, 4, ...         0.00%       0.000us         0.00%       0.000us       0.000us     683.137us         3.10%     683.137us      34.157us           0 B           0 B           0 B           0 B            20            --  
void magma_sgemmEx_kernel<float, float, float, false...         0.00%       0.000us         0.00%       0.000us       0.000us     635.395us         2.89%     635.395us       5.295us           0 B           0 B           0 B           0 B           120            --  
autograd::engine::evaluate_function: ConvolutionBack...         0.09%     168.943us         1.26%       2.282ms      38.031us       0.000us         0.00%     626.816us      10.447us           0 B           0 B     -55.21 MB    -124.45 MB            60            --  
                                   ConvolutionBackward0         0.08%     138.392us         1.17%       2.113ms      35.216us       0.000us         0.00%     626.816us      10.447us           0 B           0 B      69.24 MB           0 B            60            --  
                             aten::convolution_backward         0.34%     617.445us         1.09%       1.975ms      32.909us     366.432us         1.66%     626.816us      10.447us           0 B           0 B      69.24 MB     -61.88 MB            60            --  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     581.023us         2.64%     581.023us       4.648us           0 B           0 B           0 B           0 B           125            --  
                                             aten::add_         0.53%     950.857us         1.03%       1.858ms       2.581us     574.420us         2.61%     574.420us       0.798us           0 B           0 B           0 B           0 B           720            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x64_8...         0.00%       0.000us         0.00%       0.000us       0.000us     569.311us         2.59%     569.311us      11.386us           0 B           0 B           0 B           0 B            50            --  
                                       aten::contiguous         0.05%      86.813us         0.69%       1.242ms       8.562us       0.000us         0.00%     555.714us       3.833us           0 B           0 B     157.33 MB           0 B           145            --  
                                            aten::fill_         0.53%     954.758us         1.32%       2.380ms       3.689us     532.679us         2.42%     532.679us       0.826us           0 B           0 B           0 B           0 B           645            --  
      autograd::engine::evaluate_function: MulBackward0         0.28%     496.298us         1.29%       2.329ms      15.524us       0.000us         0.00%     498.978us       3.327us        -800 B        -800 B     -46.79 MB    -244.88 MB           150            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     493.010us         2.24%     493.010us       1.233us           0 B           0 B           0 B           0 B           400            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     469.925us         2.13%     469.925us       0.832us           0 B           0 B           0 B           0 B           565            --  
                                              aten::cat         0.57%       1.020ms         0.86%       1.543ms       7.347us     461.590us         2.10%     462.678us       2.203us           0 B           0 B     145.17 MB     145.17 MB           210            --  
                                            aten::zero_         0.30%     539.367us         1.39%       2.511ms       4.525us       0.000us         0.00%     462.405us       0.833us           0 B           0 B           0 B           0 B           555            --  
      autograd::engine::evaluate_function: DivBackward0         0.12%     210.511us         1.09%       1.963ms      43.629us       0.000us         0.00%     461.686us      10.260us           0 B           0 B     -43.63 MB    -136.64 MB            45            --  
                                           aten::conv1d         0.04%      79.471us         1.00%       1.810ms      30.175us       0.000us         0.00%     460.420us       7.674us           0 B           0 B      68.18 MB           0 B            60            --  
                                      aten::convolution         0.09%     171.325us         0.96%       1.731ms      28.850us       0.000us         0.00%     460.420us       7.674us           0 B           0 B      68.18 MB     -31.79 MB            60            --  
                                     aten::_convolution         0.19%     351.790us         0.86%       1.560ms      25.995us       0.000us         0.00%     460.420us       7.674us           0 B           0 B      99.98 MB     -34.12 MB            60            --  
                                              aten::div         0.50%     901.510us         0.83%       1.503ms       5.567us     426.592us         1.94%     426.592us       1.580us          48 B          48 B     237.93 MB     237.93 MB           270            --  
                                      aten::masked_fill         0.28%     508.920us         1.86%       3.358ms      20.988us       0.000us         0.00%     413.508us       2.584us           0 B           0 B     152.38 MB           0 B           160            --  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     401.509us         1.82%     401.509us       0.923us           0 B           0 B           0 B           0 B           435            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us     387.488us         1.76%     387.488us      12.916us           0 B           0 B           0 B           0 B            30            --  
                                            aten::zeros         0.31%     555.568us         1.80%       3.249ms       7.141us       0.000us         0.00%     383.110us       0.842us           0 B           0 B     469.48 MB           0 B           455            --  
void cutlass::Kernel2<cutlass_80_simt_sgemm_128x32_8...         0.00%       0.000us         0.00%       0.000us       0.000us     366.143us         1.66%     366.143us      18.307us           0 B           0 B           0 B           0 B            20            --  
autograd::engine::evaluate_function: torch::autograd...         0.16%     296.960us         1.98%       3.568ms      35.685us       0.000us         0.00%     359.179us       3.592us           0 B           0 B           0 B    -118.09 MB           100            --  
                            torch::autograd::CopySlices         0.24%     440.826us         1.81%       3.272ms      32.715us       0.000us         0.00%     359.179us       3.592us           0 B           0 B     118.09 MB     -27.63 MB           100            --  
                                    aten::_foreach_mul_         0.20%     367.954us         0.77%       1.397ms      55.892us     313.825us         1.43%     336.673us      13.467us           0 B           0 B           0 B           0 B            25            --  
void magma_sgemmEx_kernel<float, float, float, true,...         0.00%       0.000us         0.00%       0.000us       0.000us     332.674us         1.51%     332.674us       4.158us           0 B           0 B           0 B           0 B            80            --  
                                           DivBackward0         0.11%     196.044us         0.73%       1.322ms      29.380us       0.000us         0.00%     328.317us       7.296us           0 B           0 B      92.81 MB    -148.77 MB            45            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     318.073us         1.44%     318.073us       1.272us           0 B           0 B           0 B           0 B           250            --  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     312.983us         1.42%     312.983us       1.956us           0 B           0 B           0 B           0 B           160            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     305.793us         1.39%     305.793us       1.799us           0 B           0 B           0 B           0 B           170            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     296.290us         1.35%     296.290us       1.646us           0 B           0 B           0 B           0 B           180            --  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     292.739us         1.33%     292.739us       0.976us           0 B           0 B           0 B           0 B           300            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     275.745us         1.25%     275.745us      13.787us           0 B           0 B           0 B           0 B            20            --  
                                              aten::add         0.44%     802.133us         0.69%       1.251ms       6.416us     272.097us         1.24%     272.097us       1.395us           0 B           0 B     105.85 MB     105.85 MB           195        25.904  
                                           MulBackward0         0.13%     239.646us         0.73%       1.321ms       8.808us       0.000us         0.00%     268.644us       1.791us           0 B           0 B     198.05 MB           0 B           150            --  
                                     aten::masked_fill_         0.29%     514.234us         0.59%       1.065ms       6.658us     259.012us         1.18%     259.012us       1.619us           0 B           0 B           0 B           0 B           160            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     259.012us         1.18%     259.012us       1.619us           0 B           0 B           0 B           0 B           160            --  
void cublasLt::splitKreduce_kernel<32, 16, int, floa...         0.00%       0.000us         0.00%       0.000us       0.000us     257.084us         1.17%     257.084us       1.978us           0 B           0 B           0 B           0 B           130            --  
autograd::engine::evaluate_function: SoftmaxBackward...         0.12%     224.558us         0.86%       1.556ms      15.564us       0.000us         0.00%     230.688us       2.307us           0 B           0 B     -81.35 MB    -167.27 MB           100            --  
                                       SoftmaxBackward0         0.09%     162.940us         0.74%       1.332ms      13.319us       0.000us         0.00%     230.688us       2.307us           0 B           0 B      85.92 MB           0 B           100            --  
                           aten::_softmax_backward_data         0.25%     442.462us         0.65%       1.169ms      11.689us     117.506us         0.53%     230.688us       2.307us           0 B           0 B      85.92 MB       5.76 MB           100            --  
                                           aten::arange         0.30%     534.226us         1.16%       2.086ms       6.322us     113.607us         0.52%     227.214us       0.689us           0 B           0 B     240.00 KB       1.00 KB           330            --  
autograd::engine::evaluate_function: MaskedFillBackw...         0.12%     223.697us         1.08%       1.940ms      24.256us       0.000us         0.00%     217.863us       2.723us           0 B           0 B      -3.96 MB     -81.35 MB            80            --  
                                    MaskedFillBackward0         0.04%      80.905us         0.95%       1.717ms      21.459us       0.000us         0.00%     217.863us       2.723us           0 B           0 B      77.38 MB           0 B            80            --  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.02%      35.720us         0.20%     353.733us      35.373us       0.000us         0.00%     213.985us      21.398us           0 B           0 B      -3.92 MB     -14.93 MB            10            --  
                                         clip_grad_norm         1.59%       2.872ms         4.74%       8.561ms       1.712ms       0.000us         0.00%     211.040us      42.208us           0 B           0 B           0 B    -160.00 KB             5            --  
                                aten::_conv_depthwise2d         0.09%     158.514us         0.24%     431.084us       7.185us     209.409us         0.95%     209.409us       3.490us           0 B           0 B      68.18 MB           0 B            60            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     209.409us         0.95%     209.409us       3.490us           0 B           0 B           0 B           0 B            60            --  
                                     EmbeddingBackward0         0.01%      14.701us         0.16%     293.642us      29.364us       0.000us         0.00%     205.442us      20.544us           0 B           0 B       6.13 MB           0 B            10            --  
                               aten::embedding_backward         0.01%      11.830us         0.15%     278.941us      27.894us       0.000us         0.00%     205.442us      20.544us           0 B           0 B       6.13 MB           0 B            10            --  
                         aten::embedding_dense_backward         0.03%      52.412us         0.15%     267.111us      26.711us     175.266us         0.80%     205.442us      20.544us           0 B           0 B       6.13 MB     -10.04 MB            10            --  
      autograd::engine::evaluate_function: PowBackward0         0.10%     187.851us         0.98%       1.773ms      39.396us       0.000us         0.00%     200.797us       4.462us           0 B           0 B     -94.04 MB    -144.06 MB            45            --  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     190.366us         0.86%     190.366us       0.428us           0 B           0 B           0 B           0 B           445            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     185.247us         0.84%     185.247us       3.087us           0 B           0 B           0 B           0 B            60            --  
void at::native::(anonymous namespace)::conv_depthwi...         0.00%       0.000us         0.00%       0.000us       0.000us     181.185us         0.82%     181.185us       3.020us           0 B           0 B           0 B           0 B            60            --  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     180.035us         0.82%     180.035us       1.800us           0 B           0 B           0 B           0 B           100            --  
void at::native::elementwise_kernel<128, 4, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     179.743us         0.82%     179.743us       1.797us           0 B           0 B           0 B           0 B           100            --  
                                   aten::_foreach_lerp_         0.04%      63.303us         0.05%      93.174us       9.317us     176.416us         0.80%     176.416us      17.642us           0 B           0 B           0 B           0 B            10            --  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     176.416us         0.80%     176.416us      17.642us           0 B           0 B           0 B           0 B            10            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 180.429ms
Self CUDA time total: 22.013ms
